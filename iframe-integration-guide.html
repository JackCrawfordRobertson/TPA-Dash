<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Iframe Integration Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #01D6B0;
            margin-bottom: 1rem;
            border-bottom: 3px solid #01D6B0;
            padding-bottom: 0.5rem;
        }

        h2 {
            color: #323D4D;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        h3 {
            color: #01D6B0;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        p {
            margin-bottom: 1rem;
        }

        .important {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
        }

        .success {
            background-color: #d1f2eb;
            border-left: 4px solid #01D6B0;
            padding: 1rem;
            margin: 1rem 0;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            color: #e83e8c;
        }

        pre code {
            color: #333;
        }

        .section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e0e0e0;
        }

        ul {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background-color: #01D6B0;
            color: white;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Dashboard Iframe Integration Guide</h1>

        <div class="success">
            <strong>‚úÖ What's Been Fixed:</strong>
            <ul style="margin-top: 0.5rem; margin-bottom: 0;">
                <li>Dashboards now automatically resize charts when switching between desktop and mobile (no refresh needed)</li>
                <li>Dashboards send their height to parent page for dynamic iframe sizing</li>
                <li>All three dashboards updated with resize detection and height communication</li>
            </ul>
        </div>

        <!-- ============================================ -->
        <!-- OPTION 1: UNIVERSAL LISTENER -->
        <!-- ============================================ -->
        <div class="section">
            <h2>üéØ Option 1: Universal Listener (Recommended)</h2>
            <p>Add this single code block to your Elementor page to handle ALL dashboards automatically. This is the easiest solution if you have multiple dashboards on the same page or across your site.</p>

            <h3>Where to Add This Code:</h3>
            <ul>
                <li>In Elementor: Add a <strong>Custom HTML</strong> widget</li>
                <li>Or add to your theme's footer (Appearance ‚Üí Customize ‚Üí Additional CSS/JS)</li>
                <li>Or in Elementor's Custom Code section (if available)</li>
            </ul>

            <pre><code>&lt;script&gt;
// Universal iframe height adjuster for all TPA dashboards
window.addEventListener('message', function(event) {
  // Verify the message is from our dashboards
  if (event.data && event.data.type === 'dashboard-height') {
    const height = event.data.height;
    const dashboard = event.data.dashboard;

    console.log('Received height from dashboard:', dashboard, height + 'px');

    // Find all iframes and update the matching one
    const iframes = document.querySelectorAll('iframe');
    iframes.forEach(function(iframe) {
      const src = iframe.src.toLowerCase();

      // Check if iframe src matches the dashboard
      if (src.includes('industry_outlook_key_challenge') ||
          src.includes('merchant-dashboard') ||
          src.includes('global-reach-growth')) {

        // Update iframe height with 20px padding
        iframe.style.height = (height + 20) + 'px';
        console.log('Updated iframe height to:', (height + 20) + 'px');
      }
    });
  }
});
&lt;/script&gt;</code></pre>

            <div class="important">
                <strong>‚ö†Ô∏è Important:</strong> Make sure this script is added to the page BEFORE or on the same page as your iframes. It needs to be ready to listen when the dashboards load.
            </div>
        </div>

        <!-- ============================================ -->
        <!-- OPTION 2: INDIVIDUAL DASHBOARDS -->
        <!-- ============================================ -->
        <div class="section">
            <h2>üéØ Option 2: Individual Dashboard Integration</h2>
            <p>Use these if you want more control over each dashboard separately. Choose the section(s) you need.</p>

            <!-- INDUSTRY OUTLOOK -->
            <h3><span class="badge">Dashboard 1</span>Industry Outlook Key Challenge</h3>
            <p>Copy this entire block for the Industry Outlook dashboard:</p>

            <pre><code>&lt;!-- Industry Outlook Dashboard --&gt;
&lt;iframe
  id="industry-outlook-iframe"
  src="https://calm-fudge-8ac075.netlify.app/pages/industry_outlook_key_challenge-single-screen"
  width="100%"
  height="1000"
  frameborder="0"
  allow="fullscreen"
  style="border: none; border-radius: 12px;"&gt;
&lt;/iframe&gt;

&lt;script&gt;
// Height adjuster for Industry Outlook dashboard
window.addEventListener('message', function(event) {
  if (event.data &&
      event.data.type === 'dashboard-height' &&
      event.data.dashboard === 'industry-outlook') {
    const iframe = document.getElementById('industry-outlook-iframe');
    if (iframe) {
      iframe.style.height = (event.data.height + 20) + 'px';
      console.log('Industry Outlook height updated to:', event.data.height + 'px');
    }
  }
});
&lt;/script&gt;</code></pre>

            <!-- MERCHANT DASHBOARD -->
            <h3><span class="badge">Dashboard 2</span>Merchant Dashboard</h3>
            <p>Copy this entire block for the Merchant dashboard:</p>

            <pre><code>&lt;!-- Merchant Dashboard --&gt;
&lt;iframe
  id="merchant-dashboard-iframe"
  src="https://calm-fudge-8ac075.netlify.app/pages/merchant-dashboard"
  width="100%"
  height="1000"
  frameborder="0"
  allow="fullscreen"
  style="border: none; border-radius: 12px;"&gt;
&lt;/iframe&gt;

&lt;script&gt;
// Height adjuster for Merchant dashboard
window.addEventListener('message', function(event) {
  if (event.data &&
      event.data.type === 'dashboard-height' &&
      event.data.dashboard === 'merchant-dashboard') {
    const iframe = document.getElementById('merchant-dashboard-iframe');
    if (iframe) {
      iframe.style.height = (event.data.height + 20) + 'px';
      console.log('Merchant Dashboard height updated to:', event.data.height + 'px');
    }
  }
});
&lt;/script&gt;</code></pre>

            <!-- GLOBAL REACH GROWTH -->
            <h3><span class="badge">Dashboard 3</span>Global Reach & Growth</h3>
            <p>Copy this entire block for the Global Reach & Growth dashboard:</p>

            <pre><code>&lt;!-- Global Reach & Growth Dashboard --&gt;
&lt;iframe
  id="global-reach-iframe"
  src="https://calm-fudge-8ac075.netlify.app/pages/global-reach-growth"
  width="100%"
  height="1000"
  frameborder="0"
  allow="fullscreen"
  style="border: none; border-radius: 12px;"&gt;
&lt;/iframe&gt;

&lt;script&gt;
// Height adjuster for Global Reach dashboard
window.addEventListener('message', function(event) {
  if (event.data &&
      event.data.type === 'dashboard-height' &&
      event.data.dashboard === 'global-reach-growth') {
    const iframe = document.getElementById('global-reach-iframe');
    if (iframe) {
      iframe.style.height = (event.data.height + 20) + 'px';
      console.log('Global Reach height updated to:', event.data.height + 'px');
    }
  }
});
&lt;/script&gt;</code></pre>
        </div>

        <!-- ============================================ -->
        <!-- TESTING GUIDE -->
        <!-- ============================================ -->
        <div class="section">
            <h2>üß™ Testing Guide</h2>

            <h3>Step 1: Deploy Updated Dashboards</h3>
            <ol>
                <li>Commit and push your changes to GitHub/Git</li>
                <li>Wait for Netlify to rebuild (usually 1-2 minutes)</li>
                <li>Verify the dashboards are updated on Netlify</li>
            </ol>

            <h3>Step 2: Add Code to Elementor</h3>
            <ol>
                <li>Go to your Elementor page editor</li>
                <li>Add a Custom HTML widget (or use theme customizer)</li>
                <li>Paste the code from <strong>Option 1</strong> (recommended) or <strong>Option 2</strong></li>
                <li>Save and publish</li>
            </ol>

            <h3>Step 3: Test the Integration</h3>
            <ol>
                <li><strong>Desktop Test:</strong> Load page on desktop - check console for "Sent height to parent" messages</li>
                <li><strong>Resize Test:</strong> Resize browser from desktop to mobile width - charts should rebuild automatically</li>
                <li><strong>Mobile Test:</strong> Load page on actual mobile device - should display correctly without scrolling issues</li>
                <li><strong>Height Test:</strong> Check that iframe height matches content (no cut-off or excessive whitespace)</li>
            </ol>

            <div class="success">
                <strong>‚úÖ Success Indicators:</strong>
                <ul style="margin-top: 0.5rem; margin-bottom: 0;">
                    <li>Console shows: "Sent height to parent: XXXXpx"</li>
                    <li>Console shows: "Updated iframe height to: XXXXpx"</li>
                    <li>Charts rebuild when resizing between desktop/mobile (no refresh needed)</li>
                    <li>No scrollbars inside the iframe</li>
                    <li>Content fits perfectly without being cut off</li>
                </ul>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- TROUBLESHOOTING -->
        <!-- ============================================ -->
        <div class="section">
            <h2>üîß Troubleshooting</h2>

            <h3>Problem: Iframe height not updating</h3>
            <ul>
                <li>Check browser console (F12) for messages</li>
                <li>Verify the script is on the same page as the iframe</li>
                <li>Check that the dashboard URL matches your Netlify URL</li>
                <li>Clear browser cache and hard reload (Ctrl+Shift+R or Cmd+Shift+R)</li>
            </ul>

            <h3>Problem: Charts not rebuilding on resize</h3>
            <ul>
                <li>Make sure you've deployed the updated dashboard files to Netlify</li>
                <li>Check console for "Charts rebuilt for X view" message</li>
                <li>Try a hard refresh to clear cache</li>
            </ul>

            <h3>Problem: Getting CORS errors</h3>
            <ul>
                <li>This shouldn't happen with postMessage, but if it does:</li>
                <li>Verify iframe src uses HTTPS (not HTTP)</li>
                <li>Make sure the URL is exactly correct (check for typos)</li>
            </ul>

            <h3>Problem: Height jumps or flickers</h3>
            <ul>
                <li>This is normal during initial load as content renders</li>
                <li>Height will stabilize after charts fully load (~500ms)</li>
                <li>If persistent, try increasing the setTimeout delay in the dashboard code</li>
            </ul>
        </div>

        <!-- ============================================ -->
        <!-- TECHNICAL DETAILS -->
        <!-- ============================================ -->
        <div class="section">
            <h2>‚öôÔ∏è Technical Details</h2>

            <h3>How It Works</h3>
            <ol>
                <li><strong>Dashboard calculates height:</strong> Uses document.body.scrollHeight and other metrics</li>
                <li><strong>Sends postMessage:</strong> Communicates height to parent window using window.postMessage()</li>
                <li><strong>Parent listens:</strong> Your Elementor page listens for 'dashboard-height' messages</li>
                <li><strong>Updates iframe:</strong> Parent dynamically sets iframe height via JavaScript</li>
            </ol>

            <h3>Message Format</h3>
            <p>Dashboards send this message structure:</p>
            <pre><code>{
  type: 'dashboard-height',
  height: 1234,  // height in pixels
  dashboard: 'industry-outlook' | 'merchant-dashboard' | 'global-reach-growth'
}</code></pre>

            <h3>Timing</h3>
            <ul>
                <li><strong>Initial send:</strong> 500ms after page load (allows charts to render)</li>
                <li><strong>On window load:</strong> 100ms after complete load</li>
                <li><strong>On resize:</strong> 250ms after resize stops (debounced)</li>
                <li><strong>After chart rebuild:</strong> Immediately when charts are recreated</li>
            </ul>

            <h3>Browser Compatibility</h3>
            <p>Works on all modern browsers:</p>
            <ul>
                <li>Chrome, Edge, Safari, Firefox (desktop and mobile)</li>
                <li>iOS Safari, Chrome Mobile, Samsung Internet</li>
                <li>Requires JavaScript enabled (which is standard)</li>
            </ul>
        </div>

        <!-- ============================================ -->
        <!-- FOOTER -->
        <!-- ============================================ -->
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 2px solid #01D6B0; text-align: center; color: #666;">
            <p><strong>Dashboard Integration Guide</strong></p>
            <p>For The Payments Association Dashboard Project</p>
            <p style="font-size: 0.85rem; margin-top: 1rem;">
                Generated: 2026-01-05 |
                Dashboards: Industry Outlook, Merchant Dashboard, Global Reach & Growth
            </p>
        </div>
    </div>
</body>
</html>
